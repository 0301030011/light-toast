{"version":3,"sources":["../../node_modules/micro-event-manager/dist/index.es.js","../../node_modules/style-inject/dist/style-inject.es.js","../../src/icon.tsx","../../src/toast.tsx","../../src/index.tsx","App.js","index.js"],"names":["eventManager","EventManager","this","_events","_publishedEvents","prototype","subscribe","name","callback","event","key","Date","now","push","publish","data","forEach","_a","unSubscribe","i","length","splice","ensureTriggeredAndSubscribe","slice","reverse","find","item","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","icons","fail","fill","loading","className","styles","success","Icon","timerId","content","duration","onClose","classes","setClasses","exit","current","scrollTop","prev","window","clearTimeout","scheduleExit","count","debounce","setTimeout","undefined","padding","borderRadius","onTransitionEnd","indexOf","marginBottom","messages","notice","container","body","render","unmountComponentAtNode","removeChild","shift","info","hide","App","onClick","Toast","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.1a2185b0.chunk.js","sourcesContent":["var EventManager = /** @class */ (function () {\r\n    function EventManager() {\r\n        this._events = {};\r\n        this._publishedEvents = [];\r\n    }\r\n    EventManager.prototype.subscribe = function (name, callback) {\r\n        if (!this._events[name]) {\r\n            this._events[name] = [];\r\n        }\r\n        var event = { key: Date.now(), callback: callback };\r\n        this._events[name].push(event);\r\n        return event.key;\r\n    };\r\n    EventManager.prototype.publish = function (name, data) {\r\n        this._publishedEvents.push({ name: name, data: data });\r\n        if (this._events[name]) {\r\n            this._events[name].forEach(function (_a) {\r\n                var callback = _a.callback;\r\n                callback(data);\r\n            });\r\n        }\r\n    };\r\n    EventManager.prototype.unSubscribe = function (name, key) {\r\n        if (this._events[name]) {\r\n            for (var i = 0; i < this._events[name].length; i++) {\r\n                if (key === this._events[name][i].key) {\r\n                    this._events[name].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    // Make sure published events can be triggered when subscribed\r\n    EventManager.prototype.ensureTriggeredAndSubscribe = function (name, callback) {\r\n        var event = this._publishedEvents\r\n            .slice()\r\n            .reverse()\r\n            .find(function (item) { return item.name === name; });\r\n        if (event) {\r\n            callback(event.data);\r\n        }\r\n        return this.subscribe(name, callback);\r\n    };\r\n    return EventManager;\r\n}());\r\nvar eventManager = new EventManager();\n\nexport default eventManager;\n//# sourceMappingURL=index.es.js.map\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React from 'react';\nimport { Type } from './types';\nimport { ReactComponent as Success } from './svg/check.svg';\nimport { ReactComponent as Loading } from './svg/loading.svg';\nimport { ReactComponent as Fail } from './svg/close.svg';\nimport styles from './style.css';\n\nconst icons = {\n  fail: <Fail fill=\"#fff\"></Fail>,\n  loading: <Loading fill=\"#fff\" className={styles.loading}></Loading>,\n  success: <Success fill=\"#fff\"></Success>,\n};\n\nexport default function Icon({ type }: { type: Type }): React.ReactElement {\n  return icons[type];\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport eventManager from 'micro-event-manager';\nimport { Type, NoArgsReturnVoidFunction } from './types';\nimport Icon from './icon';\nimport styles from './style.css';\n\nlet timerId = -1;\n\nfunction debounce(\n  callback: NoArgsReturnVoidFunction\n): NoArgsReturnVoidFunction {\n  let count = 0;\n  return (): void => {\n    if (count === 0) {\n      callback();\n      count++;\n    }\n  };\n}\n\ntype Props = {\n  type: Type;\n  content: string;\n  duration?: number;\n  onClose: NoArgsReturnVoidFunction;\n};\n\nconst Toast = ({\n  type,\n  content,\n  duration = 3000,\n  onClose,\n}: Props): React.ReactElement => {\n  const [classes, setClasses] = useState(styles.box);\n  const ref = useRef<HTMLDivElement>(null);\n\n  function exit(): void {\n    setClasses((): string => `${styles.box} ${styles.exit}`);\n  }\n\n  useEffect((): NoArgsReturnVoidFunction => {\n    // force a repaint\n    /* eslint-disable no-unused-expressions */\n    ref.current && ref.current.scrollTop;\n    /* eslint-disable no-unused-expressions */\n    setClasses((prev): string => `${prev} ${styles.enter}`);\n    const key = eventManager.subscribe('exit', exit);\n\n    return (): void => {\n      eventManager.unSubscribe('exit', key);\n      window.clearTimeout(timerId); // in case toast unmount before reaching the timeout\n    };\n  }, []);\n\n  const scheduleExit = debounce((): void => {\n    timerId = window.setTimeout(exit, duration);\n  });\n\n  return (\n    <div className={styles.mask}>\n      <div\n        className={classes}\n        style={type === 'info' ? undefined : { padding: 15, borderRadius: 5 }}\n        onTransitionEnd={(): void => {\n          // enter phase\n          if (~classes.indexOf(styles.enter) && duration !== 0) {\n            scheduleExit();\n          }\n\n          // exit phase\n          if (~classes.indexOf(styles.exit)) {\n            onClose();\n          }\n        }}\n        ref={ref}\n      >\n        {type !== 'info' && (\n          <div\n            className={styles.wrapper}\n            style={type === 'loading' ? { marginBottom: 10 } : undefined}\n          >\n            <Icon type={type}></Icon>\n          </div>\n        )}\n        <span className={styles.message}>{content}</span>\n      </div>\n    </div>\n  );\n};\n\nexport default Toast;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport eventManager from 'micro-event-manager';\nimport { Type, NoArgsReturnVoidFunction } from './types';\nimport Toast from './toast';\n\ninterface Message {\n  type: Type;\n  content: string;\n  duration?: number;\n  onClose?: NoArgsReturnVoidFunction;\n}\n\n// save messages in a queue, only remove it when component lifecycle ends\nconst messages: Message[] = [];\n\neventManager.subscribe('popmessage', (): void => {\n  const { type, content, duration, onClose } = messages[0];\n  const container = document.createElement('div');\n  document.body.appendChild(container);\n  ReactDOM.render(\n    <Toast\n      type={type}\n      content={content}\n      duration={duration}\n      onClose={(): void => {\n        ReactDOM.unmountComponentAtNode(container);\n        document.body.removeChild(container);\n        onClose && onClose();\n        messages.shift();\n        if (messages.length > 0) {\n          eventManager.publish('popmessage');\n        }\n      }}\n    ></Toast>,\n    container\n  );\n});\n\nfunction notice(\n  type: Type,\n  content: string,\n  duration?: number,\n  onClose?: NoArgsReturnVoidFunction\n): void {\n  messages.push({ type, content, duration, onClose });\n  if (messages.length === 1) {\n    eventManager.publish('popmessage');\n  }\n  // if current message is loading, then we should unmount it to proceed\n  if (messages.length > 1 && messages[0].type === 'loading') {\n    eventManager.publish('exit');\n  }\n}\n\nexport default {\n  info(\n    content: string,\n    duration?: number,\n    onClose?: NoArgsReturnVoidFunction\n  ): void {\n    notice('info', content, duration, onClose);\n  },\n  success(\n    content: string,\n    duration?: number,\n    onClose?: NoArgsReturnVoidFunction\n  ): void {\n    notice('success', content, duration, onClose);\n  },\n  fail(\n    content: string,\n    duration?: number,\n    onClose?: NoArgsReturnVoidFunction\n  ): void {\n    notice('fail', content, duration, onClose);\n  },\n  loading(content: string, onClose?: NoArgsReturnVoidFunction): void {\n    notice('loading', content, 0, onClose);\n  },\n  hide(): void {\n    if (messages.length > 0) {\n      eventManager.publish('exit');\n    }\n  },\n};\n","import React from 'react';\nimport Toast from 'light-toast';\n\nexport default function App() {\n  return (\n    <div className=\"container\">\n      <h2>Light Toast</h2>\n      <span\n        className=\"button\"\n        onClick={() => {\n          Toast.info('info');\n        }}\n      >\n        info\n      </span>\n      <span\n        className=\"button\"\n        onClick={() => {\n          Toast.success('success');\n        }}\n      >\n        success\n      </span>\n      <span\n        className=\"button\"\n        onClick={() => {\n          Toast.fail('fail');\n        }}\n      >\n        fail\n      </span>\n      <span\n        className=\"button\"\n        onClick={() => {\n          Toast.loading('loading');\n          setTimeout(() => {\n            Toast.hide();\n          }, 3000);\n        }}\n      >\n        loading\n      </span>\n    </div>\n  );\n}\n","import 'react-app-polyfill/ie9';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}